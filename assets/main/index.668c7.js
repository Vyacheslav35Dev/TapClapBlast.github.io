window.__require=function t(e,o,i){function n(s,c){if(!o[s]){if(!e[s]){var a=s.split("/");if(a=a[a.length-1],!e[a]){var l="function"==typeof __require&&__require;if(!c&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+s+"'")}s=a}var u=o[s]={exports:{}};e[s][0].call(u.exports,function(t){return n(e[s][1][t]||t)},u,u.exports,t,e,o,i)}return o[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<i.length;s++)n(i[s]);return n}({GameManager:[function(t,e,o){"use strict";cc._RF.push(e,"dcadamzOHxLQoNl6SgJsN5C","GameManager");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(s=(r<3?n(s):r>3?n(e,o,s):n(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s},s=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))(function(n,r){function s(t){try{a(i.next(t))}catch(e){r(e)}}function c(t){try{a(i.throw(t))}catch(e){r(e)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(s,c)}a((i=i.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return a([t,e])}}function a(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(c){r=[6,c],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},a=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var r=arguments[e],s=0,c=r.length;s<c;s++,n++)i[n]=r[s];return i};Object.defineProperty(o,"__esModule",{value:!0});var l=t("./Tile"),u=t("./GameTypes"),p=cc._decorator,h=p.ccclass,f=p.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tilePrefab=null,e.gameField=null,e.gridWidth=8,e.gridHeight=8,e.tileSize=80,e.uiManager=null,e.grid=[],e.selectedTile=null,e.isAnimationPlaying=!1,e.activeBooster=u.BoosterType.NONE,e.targetTile=null,e.score=0,e.movesLeft=30,e.swapBoosterCount=3,e.bombBoosterCount=99,e.curScore=0,e.curMovesLeft=0,e.curSwapBoosterCount=0,e.curBombBoosterCount=0,e.targetScore=1e3,e.maxMoves=30,e}return n(e,t),e.prototype.onLoad=function(){this.initGame()},e.prototype.initGame=function(){this.setupListeners(),this.initGrid(),this.startGame()},e.prototype.startGame=function(){console.log("Starting new game..."),this.curScore=0,this.curMovesLeft=this.movesLeft,this.curBombBoosterCount=this.bombBoosterCount,this.curSwapBoosterCount=this.swapBoosterCount,this.isAnimationPlaying=!1,this.resetActiveBooster(),this.createGrid(),this.updateUI()},e.prototype.setupListeners=function(){var t=this;this.uiManager.onSwapBoosterActivate=function(){return t.tryUseSwapBooster()},this.uiManager.onBombBoosterActivate=function(){return t.tryUseBombBooster()},this.uiManager.onRestartGame=function(){t.startGame()}},e.prototype.onDestroy=function(){this.uiManager.onSwapBoosterActivate=null,this.uiManager.onBombBoosterActivate=null,this.uiManager.onRestartGame=null},e.prototype.initGrid=function(){try{this.grid=new Array(this.gridHeight);for(var t=0;t<this.gridHeight;t++)this.grid[t]=new Array(this.gridWidth).fill(null)}catch(e){cc.error("Grid initialization error:",e),this.grid=[]}},e.prototype.createGrid=function(){this.gameField.removeAllChildren();for(var t=0;t<this.gridHeight;t++){this.grid[t]=[];for(var e=0;e<this.gridWidth;e++)this.createTileAt(e,t)}},e.prototype.createTileAt=function(t,e){var o=cc.instantiate(this.tilePrefab);o.parent=this.gameField,o.setPosition(this.getPositionForTile(t,e));var i=o.getComponent(l.default),n=Object.keys(u.TileType).length/2,r=Math.floor(Math.random()*n);i.init(t,e,r,u.BoosterType.NONE),this.grid[e][t]=o},e.prototype.getPositionForTile=function(t,e){var o=(t-this.gridWidth/2+.5)*this.tileSize,i=(e-this.gridHeight/2+.5)*this.tileSize;return cc.v2(o,i)},e.prototype.onTileClick=function(t){return s(this,void 0,Promise,function(){var e;return c(this,function(o){switch(o.label){case 0:if(this.isAnimationPlaying||this.curMovesLeft<=0)return[2];if(!(e=t.getComponent("Tile")))return[2];switch(e.gridX,e.gridY,this.activeBooster){case u.BoosterType.SWAP:return[3,1];case u.BoosterType.BOMB:return[3,2]}return[3,4];case 1:return[3,6];case 2:return[4,this.handleBombBooster(t)];case 3:return o.sent(),[3,6];case 4:return[4,this.handleNormalClick(t)];case 5:return o.sent(),[3,6];case 6:return[2]}})})},e.prototype.handleNormalClick=function(t){return s(this,void 0,Promise,function(){var e,o,i;return c(this,function(n){switch(n.label){case 0:if(this.isAnimationPlaying||this.curMovesLeft<=0||!(null==t?void 0:t.isValid))return[2];n.label=1;case 1:return n.trys.push([1,4,,5]),(e=t.getComponent(l.default))?(o=this.findSameColorTiles(e.gridX,e.gridY,e.tileType)).length<3?[2]:(this.curMovesLeft--,[4,this.removeTilesSafely(o)]):[2];case 2:return n.sent(),[4,this.fillEmptySpaces()];case 3:return n.sent(),this.updateUI(),this.checkStateWinOrLose(),[3,5];case 4:return i=n.sent(),cc.error("Error during tile click handling:",i),[3,5];case 5:return[2]}})})},e.prototype.checkStateWinOrLose=function(){if(this.curScore>=this.targetScore)return this.isAnimationPlaying=!0,void this.uiManager.showWinPanel();(this.curMovesLeft<=0||!this.hasValidMoves())&&(this.isAnimationPlaying=!0,this.uiManager.showLosePanel())},e.prototype.hasValidMoves=function(){for(var t=0;t<this.gridHeight;t++)for(var e=0;e<this.gridWidth;e++){var o=this.grid[t][e];if(o){var i=o.getComponent(l.default);if(i&&this.findSameColorTiles(e,t,i.tileType).length>=3)return!0}}return!1},e.prototype.findSameColorTiles=function(t,e,o){for(var i,n=[],r=new Set,s=[[t,e]];s.length>0;){var c=s.shift(),a=c[0],u=c[1],p=a+","+u;if(!r.has(p)&&this.isValidPosition(a,u)){var h=null===(i=this.grid[u])||void 0===i?void 0:i[a];if(null==h?void 0:h.isValid){var f=h.getComponent(l.default);f&&f.tileType===o&&(r.add(p),n.push(h),s.push([a+1,u]),s.push([a-1,u]),s.push([a,u+1]),s.push([a,u-1]))}}}return n},e.prototype.removeTilesSafely=function(t){return s(this,void 0,Promise,function(){var e,o,i=this;return c(this,function(n){switch(n.label){case 0:if(!(null==t?void 0:t.length))return[2];this.isAnimationPlaying=!0,n.label=1;case 1:return n.trys.push([1,4,5,6]),[4,this.highlightTiles(t)];case 2:return n.sent(),e=t.map(function(t){if(!t.isValid)return Promise.resolve();var e=t.getComponent(l.default);return e?(i.grid[e.gridY][e.gridX]=null,e.explode()):Promise.resolve()}),[4,Promise.all(e)];case 3:return n.sent(),this.addScore(10*t.length),[3,6];case 4:return o=n.sent(),cc.error("Error removing tiles:",o),[3,6];case 5:return this.isAnimationPlaying=!1,[7];case 6:return[2]}})})},e.prototype.highlightTiles=function(t){return s(this,void 0,Promise,function(){return c(this,function(e){switch(e.label){case 0:return[4,Promise.all(t.map(function(t){return new Promise(function(e){if(!t.isValid)return e();cc.tween(t).to(.1,{scale:1.2,color:cc.Color.RED}).to(.1,{scale:1,color:cc.Color.WHITE}).call(e).start()})}))];case 1:return e.sent(),[2]}})})},e.prototype.isValidPosition=function(t,e){return t>=0&&t<this.gridWidth&&e>=0&&e<this.gridHeight},e.prototype.findMatchesAt=function(t,e){var o;if(!this.isValidPosition(t,e)||!(null===(o=this.grid[e])||void 0===o?void 0:o[t]))return[];try{var i=this.grid[e][t].getComponent(l.default);if(!i)return[];var n=i.tileType,r=this.findMatchesInDirection(t,e,1,0,n),s=this.findMatchesInDirection(t,e,0,1,n);return a(r,s)}catch(c){return cc.error("Error finding matches at ("+t+", "+e+"):",c),[]}},e.prototype.findMatchesInDirection=function(t,e,o,i,n){for(var r,s,c=[],a=t+o,u=e+i;this.isValidPosition(a,u)&&(p=this.grid[u][a])&&(null===(r=p.getComponent(l.default))||void 0===r?void 0:r.tileType)===n;)c.push(p),a+=o,u+=i;for(a=t-o,u=e-i;this.isValidPosition(a,u);){var p;if(!(p=this.grid[u][a]))break;if((null===(s=p.getComponent(l.default))||void 0===s?void 0:s.tileType)!==n)break;c.push(p),a-=o,u-=i}return c},e.prototype.handleBombBooster=function(t){return s(this,void 0,Promise,function(){var e,o,i,n,r,s,a,l;return c(this,function(c){switch(c.label){case 0:for(e=t.getComponent("Tile"),o=e.gridX,i=e.gridY,n=[t],r=-1;r<=1;r++)for(s=-1;s<=1;s++)0===s&&0===r||(a=o+s,l=i+r,this.isValidPosition(a,l)&&n.push(this.grid[l][a]));return this.curBombBoosterCount--,[4,this.removeTilesSafely(n)];case 1:return c.sent(),[4,this.fillEmptySpaces()];case 2:return c.sent(),this.resetActiveBooster(),this.updateUI(),this.checkStateWinOrLose(),[2]}})})},e.prototype.fillEmptySpaces=function(){return s(this,void 0,Promise,function(){var t,e,o,i,n,r,s,a,p,h,f,d,y,g,v,m,b;return c(this,function(c){switch(c.label){case 0:if(this.isAnimationPlaying)return[2];this.isAnimationPlaying=!0,c.label=1;case 1:for(c.trys.push([1,,7,8]),t=[],r=0;r<this.gridWidth;r++)for(e=0,a=0;a<this.gridHeight;a++)null===this.grid[a][r]?e++:e>0&&(o=this.grid[a][r],i=a-e,this.grid[a][r]=null,this.grid[i][r]=o,(d=o.getComponent(l.default)).gridY=i,t.push(d.moveTo(r,i)));return[4,Promise.all(t)];case 2:for(c.sent(),n=[],r=0;r<this.gridWidth;r++){for(s=0,a=this.gridHeight-1;a>=0&&null===this.grid[a][r];a--)s++;for(p=0;p<s;p++)h=this.gridHeight-1-p,(f=cc.instantiate(this.tilePrefab)).parent=this.gameField,d=f.getComponent(l.default),y=Math.floor(Math.random()*Object.keys(u.TileType).length/2),g=y,d.init(r,h,g,u.BoosterType.NONE),v=h+s-p,m=this.getPositionForTile(r,v),f.setPosition(m),this.grid[h][r]=f,n.push(d.moveTo(r,h))}return[4,Promise.all(n)];case 3:return c.sent(),(b=this.findAllMatches()).length>=3?[4,this.removeMatches(b)]:[3,6];case 4:return c.sent(),[4,this.fillEmptySpaces()];case 5:c.sent(),c.label=6;case 6:return[3,8];case 7:return this.isAnimationPlaying=!1,[7];case 8:return[2]}})})},e.prototype.findAllMatches=function(){for(var t=new Set,e=0;e<this.gridHeight;e++)for(var o=0;o<this.gridWidth;o++)if(null!==this.grid[e][o]){var i=this.findMatchesAt(o,e);i.length>=3&&i.forEach(function(e){return t.add(e)})}return Array.from(t)},e.prototype.removeMatches=function(t){return s(this,void 0,Promise,function(){var e,o=this;return c(this,function(i){switch(i.label){case 0:if(0===t.length||this.isAnimationPlaying)return[2];this.isAnimationPlaying=!0,i.label=1;case 1:return i.trys.push([1,,3,4]),e=a(new Set(t)),this.addScore(10*e.length),[4,Promise.all(e.map(function(t){return t.getComponent(l.default).explode()}))];case 2:return i.sent(),e.forEach(function(t){var e=t.getComponent(l.default);o.grid[e.gridY][e.gridX]=null,t.destroy()}),[3,4];case 3:return this.isAnimationPlaying=!1,[7];case 4:return[2]}})})},e.prototype.addScore=function(t){this.curScore+=t,this.updateUI()},e.prototype.updateUI=function(){this.uiManager.setScoreCount(this.curScore,this.targetScore),this.uiManager.setMoves(this.curMovesLeft),this.uiManager.setSwapBoosterCount(this.curSwapBoosterCount),this.uiManager.setBombBoosterCount(this.curBombBoosterCount)},e.prototype.tryUseSwapBooster=function(){this.uiManager.onSwapButtonActivated(!1)},e.prototype.tryUseBombBooster=function(){console.log("Booster click"),this.curBombBoosterCount>0?(this.activeBooster=u.BoosterType.BOMB,this.uiManager.onBombButtonActivated(!0)):this.uiManager.onBombButtonActivated(!1)},e.prototype.resetActiveBooster=function(){if(this.targetTile){var t=this.targetTile.getComponent(l.default);null==t||t.removeHighlight(),this.targetTile=null}this.activeBooster=u.BoosterType.NONE},r([f(cc.Prefab)],e.prototype,"tilePrefab",void 0),r([f(cc.Node)],e.prototype,"gameField",void 0),r([f({type:cc.Integer})],e.prototype,"gridWidth",void 0),r([f({type:cc.Integer})],e.prototype,"gridHeight",void 0),r([f({type:cc.Float})],e.prototype,"tileSize",void 0),r([f(cc.Component)],e.prototype,"uiManager",void 0),r([f(cc.Integer)],e.prototype,"targetScore",void 0),r([f(cc.Integer)],e.prototype,"maxMoves",void 0),r([h],e)}(cc.Component);o.default=d,cc._RF.pop()},{"./GameTypes":"GameTypes","./Tile":"Tile"}],GameTypes:[function(t,e,o){"use strict";cc._RF.push(e,"26dafrUKolNQa39EU8nuirC","GameTypes"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterType=o.TileType=void 0,function(t){t[t.RED=0]="RED",t[t.GREEN=1]="GREEN",t[t.BLUE=2]="BLUE",t[t.YELLOW=3]="YELLOW",t[t.PURPLE=4]="PURPLE"}(o.TileType||(o.TileType={})),function(t){t[t.NONE=0]="NONE",t[t.SWAP=1]="SWAP",t[t.BOMB=2]="BOMB"}(o.BoosterType||(o.BoosterType={})),cc._RF.pop()},{}],LosePanel:[function(t,e,o){"use strict";cc._RF.push(e,"ac521/qBzpJY6wZVWYySQzo","LosePanel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(s=(r<3?n(s):r>3?n(e,o,s):n(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,c=s.ccclass,a=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.closeButton=null,e}return n(e,t),e.prototype.onLoad=function(){this.closeButton?this.closeButton.node.on("click",this.onClick,this):cc.warn("Close button is not assigned in the inspector.")},e.prototype.onDestroy=function(){this.closeButton&&this.closeButton.node.off("click",this.onClick,this)},e.prototype.onClick=function(){this.node.active=!1},r([a(cc.Button)],e.prototype,"closeButton",void 0),r([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],Tile:[function(t,e,o){"use strict";cc._RF.push(e,"82540yG0fZC7piWsIl7Rb71","Tile");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(s=(r<3?n(s):r>3?n(e,o,s):n(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s},s=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))(function(n,r){function s(t){try{a(i.next(t))}catch(e){r(e)}}function c(t){try{a(i.throw(t))}catch(e){r(e)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(s,c)}a((i=i.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return a([t,e])}}function a(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(c){r=[6,c],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./GameTypes"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.tileFrames=[],e._tileType=a.TileType.RED,e._boosterType=a.BoosterType.NONE,e._gridX=0,e._gridY=0,e.gameManager=null,e}return n(e,t),e.prototype.init=function(t,e,o,i){this._gridX=t,this._gridY=e,this._tileType=o,this._boosterType=i,this.updateVisual(),this.node.on("click",this.onClick,this),this.gameManager=cc.find("GameManager").getComponent("GameManager")},e.prototype.updateVisual=function(){this._tileType>=0&&this._tileType<this.tileFrames.length&&(this.sprite.spriteFrame=this.tileFrames[this._tileType])},e.prototype.onClick=function(){this.gameManager&&this.gameManager.onTileClick(this.node)},e.prototype.select=function(){this.node.scale=1.2},e.prototype.deselect=function(){this.node.scale=1},e.prototype.highlight=function(){this.node.stopAllActions(),this.node.color=cc.Color.YELLOW},e.prototype.removeHighlight=function(){this.node.stopAllActions(),this.node.color=cc.Color.WHITE,this.node.scale=1},e.prototype.playSwapEffect=function(){this.node.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.scaleTo(.1,1)))},e.prototype.explode=function(){var t;return s(this,void 0,Promise,function(){var e=this;return c(this,function(){return(null===(t=this.node)||void 0===t?void 0:t.isValid)?[2,new Promise(function(t){try{e.node.stopAllActions(),cc.tween(e.node).to(.2,{scale:1.5,opacity:0}).call(function(){e.node.isValid&&e.node.destroy(),t()}).start()}catch(o){cc.error("Explode animation error:",o),t()}})]:[2,Promise.resolve()]})})},e.prototype.moveTo=function(t,e){return s(this,void 0,Promise,function(){var o,i=this;return c(this,function(){if(!this.node||!this.gameManager)return[2,Promise.resolve()];try{return this._gridX=t,this._gridY=e,o=this.gameManager.getPositionForTile(t,e),[2,new Promise(function(t){i.node.stopAllActions(),cc.tween(i.node).to(.3,{position:o}).call(t).start()})]}catch(n){return cc.error("Tile move error:",n),[2,Promise.resolve()]}return[2]})})},Object.defineProperty(e.prototype,"tileType",{get:function(){return this._tileType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"boosterType",{get:function(){return this._boosterType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gridX",{get:function(){return this._gridX},set:function(t){this._gridX=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gridY",{get:function(){return this._gridY},set:function(t){this._gridY=t},enumerable:!1,configurable:!0}),r([p(cc.Sprite)],e.prototype,"sprite",void 0),r([p([cc.SpriteFrame])],e.prototype,"tileFrames",void 0),r([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"./GameTypes":"GameTypes"}],UiManager:[function(t,e,o){"use strict";cc._RF.push(e,"51d50cUaAxOrqs9/uPEwe9T","UiManager");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(s=(r<3?n(s):r>3?n(e,o,s):n(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./WinPanel"),c=t("./LosePanel"),a=cc._decorator,l=a.ccclass,u=a.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scoreLabel=null,e.movesLabel=null,e.bombCountLabel=null,e.swapCountLabel=null,e.winPanel=null,e.losePanel=null,e.swapButton=null,e.bombButton=null,e.winCloseButton=null,e.loseCloseButton=null,e.onSwapBoosterActivate=null,e.onBombBoosterActivate=null,e.onRestartGame=null,e}return n(e,t),e.prototype.onLoad=function(){this.swapButton&&this.swapButton.node.on("click",this.onSwapClick,this),this.bombButton&&this.bombButton.node.on("click",this.onBombClick,this),this.winCloseButton&&this.winCloseButton.node.on("click",this.onClickRestart,this),this.loseCloseButton&&this.loseCloseButton.node.on("click",this.onClickRestart,this)},e.prototype.onDestroy=function(){this.swapButton&&this.swapButton.node.off("click",this.onSwapClick,this),this.bombButton&&this.bombButton.node.off("click",this.onBombClick,this),this.winCloseButton&&this.winCloseButton.node.off("click",this.onClickRestart,this),this.loseCloseButton&&this.loseCloseButton.node.off("click",this.onClickRestart,this)},e.prototype.onClickRestart=function(){this.onRestartGame?this.onRestartGame():console.log("Restart callback not assigned")},e.prototype.onSwapClick=function(){this.onSwapBoosterActivate&&this.onSwapBoosterActivate()},e.prototype.onBombClick=function(){this.onBombBoosterActivate&&this.onBombBoosterActivate()},e.prototype.onSwapButtonActivated=function(t){this.swapButton&&this.swapButton.node&&(this.shakeButton(this.swapButton.node),t&&this.highlightButton(this.swapButton.node))},e.prototype.onBombButtonActivated=function(t){this.bombButton&&this.bombButton.node&&(this.shakeButton(this.bombButton.node),t&&this.highlightButton(this.bombButton.node))},e.prototype.highlightButton=function(t){t.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.scaleTo(.1,1)))},e.prototype.shakeButton=function(t){t.runAction(cc.sequence(cc.moveBy(.05,cc.v2(5,0)),cc.moveBy(.05,cc.v2(-10,0)),cc.moveBy(.05,cc.v2(10,0)),cc.moveBy(.05,cc.v2(-5,0))))},e.prototype.setSwapBoosterCount=function(t){this.swapCountLabel&&(this.swapCountLabel.string=""+t)},e.prototype.setBombBoosterCount=function(t){this.bombCountLabel&&(this.bombCountLabel.string=""+t)},e.prototype.setScoreCount=function(t,e){this.scoreLabel&&(this.scoreLabel.string=t+"/"+e)},e.prototype.setMoves=function(t){this.movesLabel&&(this.movesLabel.string=""+t)},e.prototype.showWinPanel=function(){if(this.winPanel&&this.winPanel.node){var t=this.winPanel.node;t.active=!0,t.scale=.5,cc.tween(t).to(.5,{scale:1},{easing:"backOut"}).call(function(){}).start()}},e.prototype.showLosePanel=function(){if(this.losePanel&&this.losePanel.node){var t=this.losePanel.node;t.active=!0,t.scale=.5,t.opacity=0,cc.tween(t).to(.3,{opacity:255}).to(.5,{scale:1},{easing:"backOut"}).call(function(){}).start()}},r([u(cc.Label)],e.prototype,"scoreLabel",void 0),r([u(cc.Label)],e.prototype,"movesLabel",void 0),r([u(cc.Label)],e.prototype,"bombCountLabel",void 0),r([u(cc.Label)],e.prototype,"swapCountLabel",void 0),r([u(s.default)],e.prototype,"winPanel",void 0),r([u(c.default)],e.prototype,"losePanel",void 0),r([u(cc.Button)],e.prototype,"swapButton",void 0),r([u(cc.Button)],e.prototype,"bombButton",void 0),r([u(cc.Button)],e.prototype,"winCloseButton",void 0),r([u(cc.Button)],e.prototype,"loseCloseButton",void 0),r([l],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./LosePanel":"LosePanel","./WinPanel":"WinPanel"}],WinPanel:[function(t,e,o){"use strict";cc._RF.push(e,"561f3PD4dZOzZRBifvspU+S","WinPanel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(s=(r<3?n(s):r>3?n(e,o,s):n(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,c=s.ccclass,a=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.closeButton=null,e}return n(e,t),e.prototype.onLoad=function(){this.closeButton.node.on("click",this.onClick,this)},e.prototype.onDestroy=function(){this.closeButton.node.off("click",this.onClick,this)},e.prototype.onClick=function(){this.node.active=!1},r([a(cc.Button)],e.prototype,"closeButton",void 0),r([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}]},{},["GameManager","GameTypes","Tile","LosePanel","UiManager","WinPanel"]);